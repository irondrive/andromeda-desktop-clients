#!/usr/bin/env bash
set -e

BUILD_TYPE=Release

if ! [ -e build-$BUILD_TYPE ]; then mkdir build-$BUILD_TYPE; fi; 
rm build || true; ln -s build-$BUILD_TYPE build

cd build-$BUILD_TYPE

cmake .. -DCMAKE_BUILD_TYPE=$BUILD_TYPE "$@"

cmake --build . -j$(nproc)

if [ "$1" == "inst" ]; then
   sudo cmake --install .
fi
